% For pdflatex, uncomment the alternative font setup below

% !TeX program = pdflatex

\documentclass[11pt,twoside,openany]{book}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

% Pearson-style page geometry
\usepackage[
    paperwidth=7.5in,
    paperheight=9.25in,
    margin=0.75in,
    top=1in,
    bottom=1in,
    inner=1in,
    outer=0.75in,
    headsep=0.25in,
    headheight=24pt,
    footskip=0.3in
]{geometry}

% Pearson-style typography with C059 Roman for body text
\usepackage{iftex}
\ifXeTeX
    \usepackage{fontspec}
    \setmainfont{Courier New}[
        Ligatures=TeX,
        UprightFont={C059 Roman},
        BoldFont={C059 Bold},
        ItalicFont={C059 Italic},
        BoldItalicFont={C059 Bold Italic}
    ]
    \setsansfont[Scale=0.9]{Helvetica}
    \setmonofont{Courier New}
\else
    \ifLuaTeX
        \usepackage{fontspec}
        \setmainfont{C059 Roman}[
            Ligatures=TeX,
            UprightFont={C059 Roman},
            BoldFont={C059 Bold},
            ItalicFont={C059 Italic},
            BoldItalicFont={C059 Bold Italic}
        ]
        \setsansfont[Scale=0.9]{Helvetica}
        \setmonofont{Courier New}
    \else
        % Fallback for pdfLaTeX - use similar quality serif fonts
        \usepackage[T1]{fontenc}
        \usepackage{mathptmx}       % Times-like font (similar to C059)
        \usepackage[scaled=0.9]{helvet}
        \usepackage{courier}
    \fi
\fi
\usepackage{microtype}       % Better typography

% Essential packages
\usepackage{fancyhdr}
\usepackage{titlesec}
\usepackage{tikz}
\usetikzlibrary{shapes, arrows, positioning}
\usepackage{float}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{enumitem}
\usepackage{framed}
\usepackage{tcolorbox}
\usepackage{tabularx}
\usepackage{cite}

% Pearson color scheme
\definecolor{pearsonblue}{RGB}{0,91,156}
\definecolor{pearsongray}{RGB}{88,89,91}
\definecolor{pearsonlightblue}{RGB}{230,242,250}

% Pearson-style chapter formatting (only 'CHAPTER n.' bold)
\titleformat{\chapter}[display]
  {\normalfont\sffamily\color{pearsonblue}}
  {\LARGE\textbf{\chaptertitlename\ \thechapter} \MakeUppercase{}}
{10pt}{\Huge\sffamily\bfseries\color{pearsonblue}}[
  \vspace{10pt}\color{pearsonblue}\rule{\textwidth}{2pt}]

% Pearson-style section formatting (matching reference images)
\titleformat{\section}
{\normalfont\Large\sffamily\bfseries\color{pearsonblue}}
{\thesection}{1em}{\MakeUppercase}
[\vspace{2pt}\color{pearsonblue}\rule{\textwidth}{0.5pt}]

% Subsection formatting
\titleformat{\subsection}
{\normalfont\large\sffamily\bfseries\color{black}}
{\thesubsection}{1em}{}

% Remove middle zero from subsection numbering (6.0.1 -> 6.1)
\renewcommand{\thesubsection}{\thechapter.\arabic{subsection}}

% Subsubsection formatting 
\titleformat{\subsubsection}
{\normalfont\normalsize\sffamily\bfseries}
{\thesubsubsection}{1em}{}

% Set up Pearson-style headers and footers
\pagestyle{fancy}
\fancyhf{}
\fancyhead[LE]{\small\sffamily\color{pearsonblue}\thepage\quad\textbf{\leftmark}}
\fancyhead[RO]{\small\sffamily\color{pearsonblue}\textbf{\rightmark}\quad\thepage}
\renewcommand{\headrulewidth}{0.5pt}
\renewcommand{\headrule}{\hbox to\headwidth{\color{pearsonblue}\leaders\hrule height \headrulewidth\hfill}}

% Customize chapter and section marks
\renewcommand{\chaptermark}[1]{\markboth{\MakeUppercase{\chaptername\ \thechapter.\ #1}}{}}
\renewcommand{\sectionmark}[1]{\markright{\MakeUppercase{\thesection.\ #1}}}

% Pearson-style table of contents
\usepackage{tocloft}
% Custom List of Figures: 'Fig. <number>: <caption>' on one line
\renewcommand{\cftfigpresnum}{Fig.~}
\renewcommand{\cftfigaftersnum}{:}
\renewcommand{\cftfigfont}{\normalfont}
\renewcommand{\cftfignumwidth}{4em}
\setlength{\cftfigindent}{0pt}

% Prevent line breaks in List of Figures
\renewcommand{\cftfigpagefont}{\normalfont}
\renewcommand{\cftfigafterpnum}{\cftparfillskip}
\renewcommand{\cfttoctitlefont}{\Huge\sffamily\bfseries\color{pearsonblue}}
\renewcommand{\cftchapfont}{\sffamily\bfseries\color{pearsonblue}}
\renewcommand{\cftsecfont}{\rmfamily}
\renewcommand{\cftsubsecfont}{\rmfamily\small}


\newcommand{\toclessheading}[1]{ % #1 is the argument
    \vspace*{1cm}
    \normalfont{\huge\color{pearsonblue}\textbf{#1}} % Use the argument here
    \vspace{1cm}
}

% Enhanced caption styling
\captionsetup{
    font={small,sf},
    labelfont={bf,color=pearsonblue},
    textfont={color=pearsongray},
    format=hang,
    indention=10pt
}

% Pearson-style figure and table environments
\tcbset{
    pearsonbox/.style={
        colback=pearsonlightblue,
        colframe=pearsonblue,
        boxrule=1pt,
        arc=3pt,
        fonttitle=\sffamily\bfseries,
        coltitle=white,
        colbacktitle=pearsonblue
    }
}

% Thesis information
\newcommand{\projectTitle}{A novel approach to evaluate pedagogical outcomes using multimodal data}
\newcommand{\theauthor}{Md. Shafiqul Islam}
\newcommand{\thedegree}{Bachelor of Science}
\newcommand{\themajor}{Computer Science and Engineering}
\newcommand{\thesupervisor}{ Dr. Md. Mizanur Rahoman}
\newcommand{\thesupervisortitle}{Professor}
\newcommand{\thedepartment}{Department of Computer Science and Engineering}
\newcommand{\theuniversity}{Begum Rokeya University, Rangpur}
\newcommand{\theyear}{2025}

\begin{document}
\raggedbottom

\frontmatter
\pagestyle{plain} % Disable headers for frontmatter (before TOC)

\input{sections/titlepage.tex}
\input{sections/originality.tex}
\input{sections/approval.tex}
\input{sections/acknowledgments.tex}
\input{sections/abstract.tex}


% Table of contents without extra space or extra page
\newpage
\renewcommand{\contentsname}{Contents}
{\let\oldchapter\chapter
\renewcommand{\chapter}[1]{}
\tableofcontents
\renewcommand{\chapter}{\oldchapter}}

% Pearson-style List of Figures and Tables (unnumbered chapters, styled like TOC)
\newpage
\renewcommand{\contentsname}{List of Figures}
{\let\oldchapter\chapter
\renewcommand{\chapter}[1]{}
\listoffigures
\renewcommand{\chapter}{\oldchapter}}

\newpage
\renewcommand{\contentsname}{List of Tables}
{\let\oldchapter\chapter
\renewcommand{\chapter}[1]{}
\listoftables
\renewcommand{\chapter}{\oldchapter}}


\mainmatter
\pagestyle{fancy} % Restore headers for main content

\chapter{Introduction}
\input{sections/introduction.tex}

\chapter{Problem Statement}
\input{sections/problem.tex}

\chapter{Background}
\input{sections/background.tex}

\chapter{Related Work}
\input{sections/related_work.tex}

\chapter{Methodology}
\input{sections/methodology.tex}

\chapter{Experimental Setup}
\input{sections/experimental_setup.tex}

\chapter{Results and Discussion}
\input{sections/results_and_discussions.tex}

\chapter{Conclusion and Future Work}
\input{sections/conclusions_and_futureworks.tex}

\backmatter

\bibliographystyle{plain}
\bibliography{research}

\end{document}